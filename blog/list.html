
<section class="content-header grid-100 mobile-grid-100">
    <header>
        <h1>{$Site->getAttribute('title')}</h1>
    </header>

    {if $Site->getAttribute('short')}
    <div class="content-short">
        {$Site->getAttribute('short')}
    </div>
    {/if}
</section>

{if $Site->getAttribute('content')}
<section class="content-body grid-100 mobile-grid-100">
    {$Site->getAttribute('content')}
</section>
{/if}

<section class="content-template grid-100 mobile-grid-100">

    {control control="\QUI\Controls\Sheets" Site=$Site sheets=$sheets}

    {foreach from=$children item=Child}
    {assign var=Child value=$Child->load()}

    <article class="qui-blog-list-entry">

        <h2>
            <a href="{url site=$Child}">
                <span>{$Child->getAttribute('title')}</span>
            </a>
        </h2>

        <p class="qui-blog-list-entry-date">
            {user id=$Child->getAttribute('c_user') var=User}
            {t}package/blog list.blog.by{/t}
            <span class="qui-blog-list-entry-date-author">
                {if $User->getId() && $User->getAttribute('firstname')}
                    {$User->getAttribute('firstname')}
                {else if $User->getId()}
                    {$User->getname()}
                {/if}
            </span>

            {t}package/blog list.blog.on{/t}
            {if $Child->getAttribute('release_from') &&
                $Child->getAttribute('release_from') != '0000-00-00 00:00:00'}
                {$Child->getAttribute('release_from')|date_format:"%d.%m.%Y"}
            {else}
                {$Child->getAttribute('c_date')|date_format:"%d.%m.%Y"}
            {/if}
        </p>

        <div class="qui-blog-list-entry-content grid-100 grid-parent">

            {assign var=bg value=""}

            {if $Child->getAttribute('image_site')}
                {image src=$Child->getAttribute('image_site') height="100" type="resize" onlysrc=1 assign=bg}
            {/if}

            {if $bg}
            <a href="{url site=$Child}"
               title="{$Child->getAttribute('title')|escape:"html"}"
               class="qui-blog-list-entry-imagelink hide-on-mobile"
               style="background-image: url({$bg})"
            >
                <span>{$Child->getAttribute('title')}</span>
            </a>
            {/if}

            <div class="qui-blog-list-entry-short grid-75 grid-parent">
                {$Child->getAttribute('short')}
                <a href="{url site=$Child}">
                    {locale group="package/blog" value="list.more"}
                </a>
            </div>

        </div>
    </article>
    {/foreach}

    {control control="\QUI\Controls\Sheets" Site=$Site sheets=$sheets}
</section>
